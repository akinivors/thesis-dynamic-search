========================================================================================================================
COMPREHENSIVE EXPERIMENT: Pre-Filter vs Post-Filter
========================================================================================================================

Timestamp: 2025-12-17 21:05:42.201724
Log file: experiment_results_20251217_210542.log
Results file: experiment_results_20251217_210542.json

Testing:
  Strategies: Pre-Filter HNSW vs Post-Filter HNSW
  Filter Types:  Categorical vs Numeric
  Cache Status: Cached vs Not Cached
========================================================================================================================

[1/4] Initializing engine...

[2/4] Examining what's cached...

Cache Statistics:
  Total cached indexes: 7
  Categorical cached: 0
  Numeric cached: 7

  Categorical cache keys (first 10):

  Numeric cache keys:
    - price>25
    - price>50
    - price>75
    - price>100
    - price>150
    - price>200
    - price>300

[3/4] Test query: 'high quality laptop computer'

[4/4] Running 7 test cases...
========================================================================================================================

========================================================================================================================
TEST 1/7:  Categorical - Cached (Electronics)
========================================================================================================================
  Type: categorical
  Cached: True
  Matching items:  0 (0.00%)
  Cache key: 'Electronics'
  Actually in cache: False

  >>> STRATEGY 1: PRE-FILTER HNSW
      ⚠️  NOT IN CACHE - Building temp index...
      No matching items - skipping index build
      Total time: 1.56ms
      Results: 0/10 items

  >>> STRATEGY 2: POST-FILTER HNSW
      Total time: 1.67ms
      Results:  0/10 items

  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
  COMPARISON:
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
    Pre-Filter:        1.56ms
    Post-Filter:      1.67ms
    Winner: Pre-Filter (1.1x faster)
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────

========================================================================================================================
TEST 2/7:  Categorical - Cached (Computers)
========================================================================================================================
  Type: categorical
  Cached: True
  Matching items:  3,605 (7.21%)
  Cache key: 'Computers'
  Actually in cache: False

  >>> STRATEGY 1: PRE-FILTER HNSW
      ⚠️  NOT IN CACHE - Building temp index...
      Built temp HNSW:  21.6ms
      Total time: 609.13ms
      Results: 10/10 items

  >>> STRATEGY 2: POST-FILTER HNSW
      Total time: 64.56ms
      Results:  10/10 items

  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
  COMPARISON:
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
    Pre-Filter:      609.13ms
    Post-Filter:     64.56ms
    Winner: Post-Filter (9.4x faster)
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────

========================================================================================================================
TEST 3/7:  Categorical - NOT Cached (Rare)
========================================================================================================================
  Type: categorical
  Cached: False
  Matching items:  0 (0.00%)
  Cache key: 'RareTestAttribute999'
  Actually in cache: False

  >>> STRATEGY 1: PRE-FILTER HNSW
      ⚠️  NOT IN CACHE - Building temp index...
      No matching items - skipping index build
      Total time: 1.55ms
      Results: 0/10 items

  >>> STRATEGY 2: POST-FILTER HNSW
      Total time: 0.71ms
      Results:  0/10 items

  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
  COMPARISON:
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
    Pre-Filter:        1.55ms
    Post-Filter:      0.71ms
    Winner: Post-Filter (2.2x faster)
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────

========================================================================================================================
TEST 4/7:  Numeric - Cached (price > $100)
========================================================================================================================
  Type: numeric
  Cached: True
  Matching items:  916 (1.83%)
  Cache key: 'price>100'
  Actually in cache: True

  >>> STRATEGY 1: PRE-FILTER HNSW
      Total time: 0.13ms
      Results: 10/10 items

  >>> STRATEGY 2: POST-FILTER HNSW
      Total time: 0.77ms
      Results:  3/10 items

  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
  COMPARISON:
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
    Pre-Filter:        0.13ms
    Post-Filter:      0.77ms
    Winner: Pre-Filter (6.0x faster)
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────

========================================================================================================================
TEST 5/7:  Numeric - Cached (price > $200)
========================================================================================================================
  Type: numeric
  Cached: True
  Matching items:  365 (0.73%)
  Cache key: 'price>200'
  Actually in cache: True

  >>> STRATEGY 1: PRE-FILTER HNSW
      Total time: 0.11ms
      Results: 10/10 items

  >>> STRATEGY 2: POST-FILTER HNSW
      Total time: 0.86ms
      Results:  1/10 items

  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
  COMPARISON:
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
    Pre-Filter:        0.11ms
    Post-Filter:      0.86ms
    Winner: Pre-Filter (8.1x faster)
  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────

========================================================================================================================
TEST 6/7:  Numeric - NOT Cached (price > $137)
========================================================================================================================
  Type: numeric
  Cached: False
  Matching items:  664 (1.33%)
  Cache key: 'price>137'
  Actually in cache: False

  >>> STRATEGY 1: PRE-FILTER HNSW
